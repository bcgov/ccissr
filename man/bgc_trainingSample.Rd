% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bgc_trainingSample.R
\name{bgc_trainingSample}
\alias{bgc_trainingSample}
\title{Generate a Balanced Training Sample from BGC Units}
\usage{
bgc_trainingSample(
  dem,
  bgcs,
  bgcs_info = NULL,
  scheme = c("asymptotic", "squareRoot"),
  squareRoot.multiplier = 10,
  removeOutliers = FALSE,
  alpha.BC = 0.0027,
  alpha.nonBC = 0.05,
  removeOutliers.vars = c("PPT_sp", "PPT_sm", "PPT_at", "PPT_wt", "Tmax_sp", "Tmax_sm",
    "Tmax_at", "Tmax_wt", "Tmin_sp", "Tmin_sm", "Tmin_at", "Tmin_wt"),
  climaticVariance = FALSE,
  climaticVariance.var = "MAT",
  bgcs.remove = NULL,
  plotDiagnostics = TRUE,
  plot.dir = NULL,
  plot.name = "bgc_trainingSample_plot",
  ...
)
}
\arguments{
\item{dem}{A \code{SpatRaster} of the digital elevation model.}

\item{bgcs}{A \code{SpatRaster} of biogeoclimatic (BGC) units, with resolution and origin matching DEM.}

\item{bgcs_info}{Optional. A \code{data.table} containing additional BGC metadata.
minimum fields are "BGC" and "Source", which must indicate non-BC units compatible with grep("USA_|AB_", bgcs_info$Source)}

\item{scheme}{Sampling scheme. One of \code{"asymptotic"} or \code{"squareRoot"}.}

\item{squareRoot.multiplier}{Numeric. Multiplier for square-root sampling (default: \code{10}).}

\item{removeOutliers}{Logical. Whether to remove climatic outliers (default: \code{FALSE}). The outlier metric is Mahalanobis distance.}

\item{alpha.BC}{Numeric. Significance level for outlier removal in BC BGC units (default of \code{0.0027} corresponds to 3-sigma outliers).}

\item{alpha.nonBC}{Numeric. Significance level for outlier removal in non-BC BGC units (default of \code{0.05} corresponds to 2-sigma outliers).}

\item{removeOutliers.vars}{Character vector. Climatic variables to check for outliers.}

\item{climaticVariance}{Logical. Whether to adjust sample size based on climatic variance.}

\item{climaticVariance.var}{Character. Variable used for climatic variance scaling. Default "MAT" is mean annual temperature.}

\item{bgcs.remove}{Character vector. BGC units to exclude from sampling.}

\item{plotDiagnostics}{Logical. Whether to generate diagnostic plots (default: \code{TRUE}).}

\item{plot.dir}{character. The directory to save the plot generated when \code{plotDiagnostics = TRUE}.}

\item{plot.name}{character. The filename for the plot generated when \code{plotDiagnostics = TRUE}. Do not include the file extension (.png) as this is hardcoded.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A \code{data.table} containing the subsampled points with columns \code{id}, \code{lon}, \code{lat}, \code{elev}, and \code{BGC}.
}
\description{
This function extracts a training sample from a DEM and BGC raster dataset,
balancing sample sizes based on different schemes and optionally removing outliers.
}
\details{
The function follows these steps:
\enumerate{
\item Extracts point data from the DEM and BGC rasters.
\item Optionally removes specified BGC units (\code{bgcs.remove}).
\item Balances sample size across BGC units using one of two subsampling schemes:
\itemize{
\item \strong{Asymptotic}: Uses an exponential function of population size towards a specified asymptote (default 4000). See \code{ccissr::subsample()}.
\item \strong{SquareRoot}: Square root of population size, multiplied by a specified factor. The default multiplier of 10 would yield a 1:1 subsample for N <= 100.
}
\item Optionally adjusts sample size based on climatic variance (\code{climaticVariance}).
\item Optionally removes outliers from the sample based on climate variables.
\item Generates diagnostic plots if \code{plotDiagnostics = TRUE}.
}
}
\examples{
\dontrun{
library(terra)
library(data.table)

dem <- rast("path/to/dem.tif")
bgcs <- rast("path/to/bgcs.tif")

sample <- bgc_trainingSample(dem, bgcs, scheme = "asymptotic")
head(sample)
}

}
